package com.onepiece.mod;

import net.fabricmc.api.ModInitializer;
import net.fabricmc.fabric.api.item.v1.FabricItemSettings;
import net.fabricmc.fabric.api.itemgroup.v1.FabricItemGroup;
import net.fabricmc.fabric.api.object.builder.v1.entity.FabricDefaultAttributeRegistry;
import net.minecraft.item.Item;
import net.minecraft.item.ItemGroup;
import net.minecraft.item.ItemStack;
import net.minecraft.registry.Registries;
import net.minecraft.registry.Registry;
import net.minecraft.registry.RegistryKey;
import net.minecraft.registry.RegistryKeys;
import net.minecraft.text.Text;
import net.minecraft.util.Identifier;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class OnePieceMod implements ModInitializer {
    public static final String MOD_ID = "onepiecemod";
    public static final Logger LOGGER = LoggerFactory.getLogger(MOD_ID);

    // PARAMECIA TYPE DEVIL FRUITS
    public static final Item GOMU_GOMU_FRUIT = registerItem("gomu_gomu_fruit", 
        new GomuGomuFruit(new FabricItemSettings().maxCount(1)));
    public static final Item HANA_HANA_FRUIT = registerItem("hana_hana_fruit",
        new HanaHanaFruit(new FabricItemSettings().maxCount(1)));
    public static final Item NIKYU_NIKYU_FRUIT = registerItem("nikyu_nikyu_fruit",
        new NikyuNikyuFruit(new FabricItemSettings().maxCount(1)));

    // LOGIA TYPE DEVIL FRUITS
    public static final Item MERA_MERA_FRUIT = registerItem("mera_mera_fruit", 
        new MeraMeraFruit(new FabricItemSettings().maxCount(1)));
    public static final Item HIE_HIE_FRUIT = registerItem("hie_hie_fruit", 
        new HieHieFruit(new FabricItemSettings().maxCount(1)));
    public static final Item PIKA_PIKA_FRUIT = registerItem("pika_pika_fruit",
        new PikaPikaFruit(new FabricItemSettings().maxCount(1)));
    public static final Item GORO_GORO_FRUIT = registerItem("goro_goro_fruit",
        new GoroGoroFruit(new FabricItemSettings().maxCount(1)));
    public static final Item MAGU_MAGU_FRUIT = registerItem("magu_magu_fruit",
        new MaguMaguFruit(new FabricItemSettings().maxCount(1)));

    // ZOAN TYPE DEVIL FRUITS
    public static final Item HITO_HITO_FRUIT = registerItem("hito_hito_fruit",
        new HitoHitoFruit(new FabricItemSettings().maxCount(1)));
    public static final Item TORI_TORI_PHOENIX = registerItem("tori_tori_phoenix",
        new ToriToriPhoenix(new FabricItemSettings().maxCount(1)));
    public static final Item ZOU_ZOU_FRUIT = registerItem("zou_zou_fruit",
        new ZouZouFruit(new FabricItemSettings().maxCount(1)));

    // WEAPONS
    public static final Item WADO_ICHIMONJI = registerItem("wado_ichimonji",
        new WadoIchimonji(new FabricItemSettings().maxCount(1)));
    public static final Item SHUSUI = registerItem("shusui",
        new Shusui(new FabricItemSettings().maxCount(1)));
    public static final Item ENMA = registerItem("enma",
        new Enma(new FabricItemSettings().maxCount(1)));
    public static final Item FLINTLOCK_PISTOL = registerItem("flintlock_pistol",
        new FlintlockPistol(new FabricItemSettings().maxCount(1)));
    public static final Item CLIMATACT = registerItem("climatact",
        new Climatact(new FabricItemSettings().maxCount(1)));

    // ITEM GROUP
    public static final RegistryKey<ItemGroup> ONE_PIECE_GROUP = RegistryKey.of(
        RegistryKeys.ITEM_GROUP, new Identifier(MOD_ID, "one_piece_items"));

    @Override
    public void onInitialize() {
        LOGGER.info("One Piece Mod loading!");
        
        // Register custom item group
        Registry.register(Registries.ITEM_GROUP, ONE_PIECE_GROUP, FabricItemGroup.builder()
            .icon(() -> new ItemStack(GOMU_GOMU_FRUIT))
            .displayName(Text.literal("One Piece"))
            .entries((context, entries) -> {
                // Devil Fruits
                entries.add(GOMU_GOMU_FRUIT);
                entries.add(HANA_HANA_FRUIT);
                entries.add(NIKYU_NIKYU_FRUIT);
                entries.add(MERA_MERA_FRUIT);
                entries.add(HIE_HIE_FRUIT);
                entries.add(PIKA_PIKA_FRUIT);
                entries.add(GORO_GORO_FRUIT);
                entries.add(MAGU_MAGU_FRUIT);
                entries.add(HITO_HITO_FRUIT);
                entries.add(TORI_TORI_PHOENIX);
                entries.add(ZOU_ZOU_FRUIT);
                // Weapons
                entries.add(WADO_ICHIMONJI);
                entries.add(SHUSUI);
                entries.add(ENMA);
                entries.add(FLINTLOCK_PISTOL);
                entries.add(CLIMATACT);
            })
            .build());

        // Register Haki system
        HakiManager.initialize();
        
        // Register entities
        OnePieceEntities.register();
        
        LOGGER.info("One Piece Mod loaded successfully!");
    }

    private static Item registerItem(String name, Item item) {
        return Registry.register(Registries.ITEM, new Identifier(MOD_ID, name), item);
    }
}